prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>
prefix mms: <https://mms.openmbee.org/rdf/ontology/>
prefix mms-object: <https://mms.openmbee.org/rdf/objects/>
prefix m: <http://layer1-service/>
prefix m-graph: <http://layer1-service/graphs/>
prefix m-user: <http://layer1-service/users/>
prefix m-group: <http://layer1-service/groups/>
prefix m-policy: <http://layer1-service/policies/>

graph m-graph:AccessControl.Agents {
	m-user:root a mms:User ;
		mms:group m-group:SuperAdmins ;
		mms:id "root" .

	m-group:SuperAdmins a mms:Group ;
		mms:id "super_admins" .
}

graph m-graph:Cluster {
	<http://layer1-service/> a mms:Cluster .
}

graph m-graph:Schema {
	mms:Ref a rdfs:Class ;
		rdfs:label "Ref" .

	mms:Branch a rdfs:Class ;
		rdfs:label "Branch" ;
		rdfs:subClassOf mms:Ref .

	mms:Lock a rdfs:Class ;
		rdfs:label "Lock" ;
		rdfs:subClassOf mms:Ref .

	mms:InterimLock a rdfs:Class ;
		rdfs:label "InterimLock" ;
		rdfs:subClassOf mms:Lock .

	mms:Snapshot a rdfs:Class ;
		rdfs:label "Snapshot" .

	mms:Model a rdfs:Class ;
		rdfs:label "Model" ;
		rdfs:subClassOf mms:Snapshot .

	mms:Staging a rdfs:Class ;
		rdfs:label "Staging" ;
		rdfs:subClassOf mms:Snapshot .

	mms:Commit a rdfs:Class ;
		rdfs:label "Commit" .

	mms:ref a rdf:Property ;
		rdfs:label "ref" ;
		rdfs:range mms:Ref .

	mms:commit a rdf:Property ;
		rdfs:label "commit" ;
		rdfs:range mms:Commit .
}

graph m-graph:AccessControl.Definitions {
	mms:Cluster a rdfs:Class ;
		rdfs:label "Cluster level scope" ;
		rdfs:subClassOf mms:Scope ;
		mms:implies mms:Org .

	mms:Org a rdfs:Class ;
		rdfs:label "Org level scope" ;
		rdfs:subClassOf mms:Scope ;
		mms:implies mms:Project .

	mms:Project a rdfs:Class ;
		rdfs:label "Project level scope" ;
		rdfs:subClassOf mms:Scope ;
		mms:implies mms:Ref .

	mms:Ref a rdfs:Class ;
		rdfs:label "Ref level scope" ;
		rdfs:subClassOf mms:Scope .

	mms:Collection a rdfs:Class ;
		rdfs:label "Collection" ;
		rdfs:subClassOf mms:Project .

	mms:Repo a rdfs:Class ;
		rdfs:label "Repo" ;
		rdfs:subClassOf mms:Project .

	mms:Branch a rdfs:Class ;
		rdfs:label "Branch" ;
		rdfs:subClassOf mms:Ref .

	mms:Lock a rdfs:Class ;
		rdfs:label "Lock" ;
		rdfs:subClassOf mms:Ref .

	mms-object:Permission.CreateCluster a mms:Permission .

	mms-object:Permission.ReadCluster a mms:Permission .

	mms-object:Permission.UpdateCluster a mms:Permission ;
		mms:implies mms-object:Permission.ReadCluster, mms-object:Permission.CreateOrg .

	mms-object:Permission.DeleteCluster a mms:Permission ;
		mms:implies mms-object:Permission.UpdateCluster, mms-object:Permission.DeleteOrg .

	mms-object:Permission.CreateOrg a mms:Permission .

	mms-object:Permission.ReadOrg a mms:Permission .

	mms-object:Permission.UpdateOrg a mms:Permission ;
		mms:implies mms-object:Permission.ReadOrg, mms-object:Permission.CreateProject .

	mms-object:Permission.DeleteOrg a mms:Permission ;
		mms:implies mms-object:Permission.UpdateOrg, mms-object:Permission.DeleteProject .

	mms-object:Permission.CreateProject a mms:Permission ;
		mms:implies mms-object:Permission.CreateCollection, mms-object:Permission.CreateRepo .

	mms-object:Permission.ReadProject a mms:Permission ;
		mms:implies mms-object:Permission.ReadCollection, mms-object:Permission.ReadRepo .

	mms-object:Permission.UpdateProject a mms:Permission ;
		mms:implies mms-object:Permission.ReadProject, mms-object:Permission.UpdateCollection, mms-object:Permission.UpdateRepo .

	mms-object:Permission.DeleteProject a mms:Permission ;
		mms:implies mms-object:Permission.UpdateProject, mms-object:Permission.DeleteCollection, mms-object:Permission.DeleteRepo .

	mms-object:Permission.CreateCollection a mms:Permission .

	mms-object:Permission.ReadCollection a mms:Permission .

	mms-object:Permission.UpdateCollection a mms:Permission ;
		mms:implies mms-object:Permission.ReadCollection .

	mms-object:Permission.DeleteCollection a mms:Permission ;
		mms:implies mms-object:Permission.UpdateCollection .

	mms-object:Permission.CreateRepo a mms:Permission .

	mms-object:Permission.ReadRepo a mms:Permission .

	mms-object:Permission.UpdateRepo a mms:Permission ;
		mms:implies mms-object:Permission.ReadRepo .

	mms-object:Permission.DeleteRepo a mms:Permission ;
		mms:implies mms-object:Permission.UpdateRepo, mms-object:Permission.CreateBranch, mms-object:Permission.DeleteBranch, mms-object:Permission.CreateLock, mms-object:Permission.DeleteLock, mms-object:Permission.CreateDiff, mms-object:Permission.DeleteDiff .

	mms-object:Permission.CreateBranch a mms:Permission .

	mms-object:Permission.ReadBranch a mms:Permission .

	mms-object:Permission.UpdateBranch a mms:Permission ;
		mms:implies mms-object:Permission.ReadBranch .

	mms-object:Permission.DeleteBranch a mms:Permission ;
		mms:implies mms-object:Permission.UpdateBranch .

	mms-object:Permission.CreateLock a mms:Permission .

	mms-object:Permission.ReadLock a mms:Permission .

	mms-object:Permission.DeleteLock a mms:Permission ;
		mms:implies mms-object:Permission.ReadLock .

	mms-object:Role.AdminOrg a mms:Role ;
		mms:permits mms-object:Permission.DeleteOrg .

	mms-object:Role.WriteOrg a mms:Role ;
		mms:permits mms-object:Permission.UpdateOrg .

	mms-object:Role.ReadOrg a mms:Role ;
		mms:permits mms-object:Permission.ReadOrg .

	mms-object:Role.AdminRepo a mms:Role ;
		mms:permits mms-object:Permission.DeleteRepo .

	mms-object:Role.WriteRepo a mms:Role ;
		mms:permits mms-object:Permission.UpdateRepo .

	mms-object:Role.ReadRepo a mms:Role ;
		mms:permits mms-object:Permission.ReadRepo .

	mms-object:Role.AdminModel a mms:Role ;
		mms:permits mms-object:Permission.DeleteModel .

	mms-object:Role.WriteModel a mms:Role ;
		mms:permits mms-object:Permission.UpdateModel .

	mms-object:Role.ReadModel a mms:Role ;
		mms:permits mms-object:Permission.ReadModel .

	mms-object:Role.AdminMetadata a mms:Role ;
		mms:permits mms-object:Permission.DeleteMetadata .

	mms-object:Role.WriteMetadata a mms:Role ;
		mms:permits mms-object:Permission.UpdateMetadata .

	mms-object:Role.ReadMetadata a mms:Role ;
		mms:permits mms-object:Permission.ReadMetadata .

	mms-object:Role.AdminCluster a mms:Role ;
		mms:permits mms-object:Permission.DeleteCluster .

	mms-object:Role.WriteCluster a mms:Role ;
		mms:permits mms-object:Permission.UpdateCluster .

	mms-object:Role.ReadCluster a mms:Role ;
		mms:permits mms-object:Permission.ReadCluster .

	mms-object:Role.AdminAccessControl a mms:Role ;
		mms:permits mms-object:Permission.DeleteAccessControl .

	mms-object:Role.WriteAccessControl a mms:Role ;
		mms:permits mms-object:Permission.UpdateAccessControl .

	mms-object:Role.ReadAccessControl a mms:Role ;
		mms:permits mms-object:Permission.ReadAccessControl .
}

