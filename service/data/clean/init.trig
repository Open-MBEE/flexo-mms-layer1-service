prefix dct: <http://purl.org/dc/terms/>
prefix xsd: <http://www.w3.org/2001/XMLSchema#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>
prefix owl: <http://www.w3.org/2002/07/owl#>

prefix mms: <https://openmbee.org/rdf/mms/ontology/>
prefix mms-object: <https://openmbee.org/rdf/mms/objects/>

base <https://mms.openmbee.org/demo/>
prefix m: <>
prefix m-graph: <graphs/>
prefix m-user: <users/>
prefix m-group: <groups/>
prefix m-policy: <policies/>

m-graph:AccessControl.Members {
	m-user:root a mms:User ;
		mms:group m-group:SuperAdmins ;
		mms:id "root" ;
		.

	m-group:SuperAdmins a mms:Group ;
		mms:id "super_admins" ;
		.
}

m-graph:AccessControl.Policies {
	m-policy:DefaultSuperAdmin a mms:Policy ;
		mms:subject m-group:SuperAdmins ;
		mms:scope mms-object:Scope.Cluster ;
		mms:role 
			mms-object:Role.AdminAccessControl,
			mms-object:Role.AdminCluster,
			mms-object:Role.AdminMetadata,
			mms-object:Role.AdminModel ;
		.
}

m-graph:AccessControl.Definitions {

	# ====================================
	# ==             Scopes             ==
	# ====================================


	mms-object:Scope.Cluster a mms:Scope ;
		dct:title "Organization level scope" ;
		.

	mms-object:Scope.Organization a mms:Scope ;
		dct:title "Organization level scope" ;
		mms:inherits mms-object:Scope.Cluster ;
		.

	mms-object:Scope.Project a mms:Scope ;
		dct:title "Project level scope" ;
		mms:inherits mms-object:Scope.Organization ;
		.

	mms-object:Scope.Branch a mms:Scope ;
		dct:title "Branch level scope" ;
		mms:inherits mms-object:Scope.Project ;
		.



	# ====================================
	# ==   Object-Centric Permissions   ==
	# ====================================

	mms-object:Permission.CreateOrg a mms:Permission ;
		.

	mms-object:Permission.ReadOrg a mms:Permission ;
		.

	mms-object:Permission.UpdateOrg a mms:Permission ;
		mms:implies mms-object:Permission.ReadOrg ;
		.

	mms-object:Permission.DeleteOrg a mms:Permission ;
		mms:implies mms-object:Permission.UpdateOrg ;
		.


	mms-object:Permission.CreateProject a mms:Permission ;
		.

	mms-object:Permission.ReadProject a mms:Permission ;
		.

	mms-object:Permission.UpdateProject a mms:Permission ;
		mms:implies mms-object:Permission.ReadProject ;
		.

	mms-object:Permission.DeleteProject a mms:Permission ;
		mms:implies mms-object:Permission.UpdateProject ;
		.



	# ====================================
	# ==    Graph-Centric Permissions   ==
	# ====================================


	# AccessControl.* graphs

	mms-object:Permission.ReadAccessControl a mms:Permission ;
		.

	mms-object:Permission.WriteAccessControl a mms:Permission ;
		mms:implies mms-object:Permission.ReadAccessControl ;
		mms:implies mms-object:Permission.CreatePolicy ;
		mms:implies mms-object:Permission.CreateRole ;
		mms:implies mms-object:Permission.CreateGroup ;
		mms:implies mms-object:Permission.CreateUser ;
		.

	mms-object:Permission.AdminAccessControl a mms:Permission ;
		mms:implies mms-object:Permission.WriteAccessControl ;
		mms:implies mms-object:Permission.DeletePolicy ;
		mms:implies mms-object:Permission.DeleteRole ;
		mms:implies mms-object:Permission.DeleteGroup ;
		mms:implies mms-object:Permission.DeleteUser ;
		.


	# The Cluster graph

	mms-object:Permission.ReadCluster a mms:Permission ;
		.

	mms-object:Permission.WriteCluster a mms:Permission ;
		mms:implies mms-object:Permission.ReadCluster ;
		mms:implies mms-object:Permission.CreateOrg ;
		mms:implies mms-object:Permission.CreateProject ;
		.

	mms-object:Permission.AdminCluster a mms:Permission ;
		mms:implies mms-object:Permission.WriteCluster ;
		mms:implies mms-object:Permission.DeleteOrg ;
		mms:implies mms-object:Permission.DeleteProject ;
		.


	# Project Metadata graphs

	mms-object:Permission.ReadMetadata a mms:Permission ;
		.

	mms-object:Permission.WriteMetadata a mms:Permission ;
		mms:implies mms-object:Permission.ReadMetadata ;
		.

	mms-object:Permission.AdminMetadata a mms:Permission ;
		mms:implies mms-object:Permission.WriteMetadata ;
		.


	# Project Model graphs

	mms-object:Permission.ReadModel a mms:Permission ;
		.

	mms-object:Permission.WriteModel a mms:Permission ;
		mms:implies mms-object:Permission.ReadModel ;
		.

	mms-object:Permission.AdminModel a mms:Permission ;
		mms:implies mms-object:Permission.WriteModel ;
		.



	# ===================================
	# ==             Roles             ==
	# ===================================


	mms-object:Role.ReadModel a mms:Role ;
		mms:permissions mms-object:Permission.ReadModel ;
		.

	mms-object:Role.WriteModel a mms:Role ;
		mms:permissions mms-object:Permission.WriteModel ;
		.

	mms-object:Role.AdminModel a mms:Role ;
		mms:permissions mms-object:Permission.AdminModel ;
		.



	mms-object:Role.ReadMetadata a mms:Role ;
		mms:permissions mms-object:Permission.ReadMetadata ;
		.

	mms-object:Role.WriteMetadata a mms:Role ;
		mms:permissions mms-object:Permission.WriteMetadata ;
		.

	mms-object:Role.AdminMetadata a mms:Role ;
		mms:permissions mms-object:Permission.AdminMetadata ;
		.



	mms-object:Role.ReadCluster a mms:Role ;
		mms:permissions mms-object:Permission.ReadCluster ;
		.

	mms-object:Role.WriteCluster a mms:Role ;
		mms:permissions mms-object:Permission.WriteCluster ;
		.

	mms-object:Role.AdminCluster a mms:Role ;
		mms:permissions mms-object:Permission.AdminCluster ;
		.



	mms-object:Role.ReadAccessControl a mms:Role ;
		mms:permissions mms-object:Permission.ReadAccessControl ;
		.

	mms-object:Role.WriteAccessControl a mms:Role ;
		mms:permissions mms-object:Permission.WriteAccessControl ;
		.

	mms-object:Role.AdminAccessControl a mms:Role ;
		mms:permissions mms-object:Permission.AdminAccessControl ;
		.
}
